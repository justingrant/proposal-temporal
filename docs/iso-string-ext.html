<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Temporal documentation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/light.min.css">
    <script type="application/javascript" src="./playground.js"></script>
    <link rel="stylesheet" type="text/css" href="./prism.css">
    <script>
      Temporal = { ...temporal.Temporal };
      Object.assign(Intl, temporal.Intl);

      // Customize output of Temporal objects for Chrome DevTools
      if (!window.devtoolsFormatters)
        window.devtoolsFormatters = [];
      window.devtoolsFormatters.push({
        header(x) {
          for (const type of [
            Temporal.Instant,
            Temporal.Calendar,
            Temporal.PlainDate,
            Temporal.PlainDateTime,
            Temporal.Duration,
            Temporal.PlainMonthDay,
            Temporal.PlainTime,
            Temporal.TimeZone,
            Temporal.PlainYearMonth
          ]) {
            if (x instanceof type) return ['span', {}, `${x[Symbol.toStringTag]} <${x}>`];
          }
          return null;
        },
        hasBody(x) {
          return x instanceof Temporal.Duration;
        },
        body(x) {
          const out = ['ol', { style: 'list-style-type: none;' }];
          for (const prop of [
            'years',
            'months',
            'weeks',
            'days',
            'hours',
            'minutes',
            'seconds',
            'milliseconds',
            'microseconds',
            'nanoseconds'
          ]) {
            if (x[prop] !== 0) out.push([
              'li',
              {},
              ['span', { style: 'color: purple;' }, prop],
              `: `,
              ['span', { style: 'color: blue;' }, x[prop]]
            ]);
          }
          return out;
        }
      });
    </script>
    <style>
      /* https://github.com/kognise/water.css/blob/master/src/variables-light.css */
      :root {
        --background: #efefef;
        --text-muted: #999999;
        --text-bright: #000000;
        --text-width: 900px;
        --variable: #39a33c;
      }
      body {
        font-size: 18px;
        max-width: var(--text-width);
        padding-top: 40px;  /* extra padding for banner */
        line-height: 1.5;
      }
      pre { border-left: 4px solid var(--variable); }
      code {
        padding: 1px 5px 2px 5px;
        line-height: 1.1;
        display: inline-block;
      }
      a code { color: inherit; }
      a code:hover { text-decoration: underline; }
      pre code { line-height: 1.4; }
      pre code[class*="language-"] { font-size: 0.85em; }
      pre[class*="language-"] { padding: 0.5em; }
      h1 { margin-top: 13px; }
      h2 { border-bottom: 2px solid var(--text-muted); margin-top: 2em; }
      h3 {
        border-bottom: 1px solid var(--text-muted);
        color: var(--text-muted);
        font-weight: normal;
      }
      h3 em { font-weight: bold; }
      h3 strong { color: var(--text-bright); }
      :not(h2) + h3 { margin-top: 2em; }
      footer {
        border-top: 1px solid var(--background);
        color: var(--text-muted);
        font-size: 0.8em;
        margin-top: 2em;
        padding-top: 10px;
      }
      .heading-link {
        left: calc((100vw - var(--text-width)) / 2 - 1.5em);
        opacity: 0;
        position: absolute;
        transition: opacity 150ms;
      }
      .heading-link:hover { text-decoration: none; }
      .heading-link::before { content: 'Â¶'; }
      h3:hover .heading-link { opacity: 1; }
      .banner {
        /* Gradient from https://joshnh.com/weblog/how-to-make-an-alert-bar/ */
        background-color: #fce94f;
        background-image: linear-gradient(135deg,
                                          transparent,
                                          transparent 25%,
                                          rgba(0, 0, 0, .05) 25%,
                                          rgba(0, 0, 0, .05) 50%,
                                          transparent 50%,
                                          transparent 75%,
                                          rgba(0, 0, 0, .05) 75%,
                                          rgba(0, 0, 0, .05));
        background-size: 20px 20px;
        box-shadow: 0 5px 0 rgba(0, 0, 0, .1);
        left: 0;
        padding: 0.4em 0;
        position: absolute;
        text-align: center;
        top: 0;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="banner">
      This proposal is <strong><a href="https://blogs.igalia.com/compilers/2020/06/23/dates-and-times-in-javascript/">experimental.</a></strong>
      It is being reviewed by TC39.
      <strong>Do</strong> try it out and <a href="https://github.com/tc39/proposal-temporal/issues">report bugs</a>; <strong>don't</strong> use it in production!
    </div>
<h1 id="ecmascript-extended-iso-8601--rfc-3339-strings">ECMAScript Extended ISO-8601 / RFC 3339 Strings</h1>
<p><a href="https://en.wikipedia.org/wiki/ISO_8601">ISO-8601</a> and <a href="https://tools.ietf.org/html/rfc3339">RFC 3339</a> are the industry standards for machine-readable serialization of dates and times.
However, there are three key use cases that are helpful for ECMAScript users that are not covered in ISO-8601 or RFC 3339:</p>
<ol>
<li>IANA Time Zone Names</li>
<li>Month/Day Syntax</li>
<li>Calendar Systems</li>
</ol>
<p>This document addresses addenda to the ISO-8601 and/or RFC 3339 spec for string serialization in the ECMAScript <code>Temporal</code> proposal.</p>
<h2 id="iana-time-zone-names">IANA Time Zone Names</h2>
<p>There is precedent in other popular datetime libraries, such as Joda Time (now java.time), for appending time zone names in brackets.
We intend to fully support this syntax in ECMAScript, both input and output.
For example:</p>
<pre><code>2007-12-03T10:15:30+01:00[Europe/Paris]</code></pre><p>Neither ISO-8601 nor RFC 3339 specifications mention this syntax, but it is adopted in <code>Temporal</code> as a de-facto industry standard.</p>
<p>The time zone string is written according to the rules of the time zone database (see <a href="timezone.html">timezone.md</a>).
These rules are documented <a href="https://htmlpreview.github.io/?https://github.com/eggert/tz/blob/master/theory.html">here</a>:</p>
<blockquote>
<p>Use only valid POSIX file name components (i.e., the parts of names other than <code>&#39;/&#39;</code>).
Do not use the file name components <code>&#39;.&#39;</code> and <code>&#39;..&#39;</code>.
Within a file name component, use only ASCII letters, <code>&#39;.&#39;</code>, <code>&#39;-&#39;</code> and <code>&#39;_&#39;</code>.
Do not use digits, as that might create an ambiguity with POSIX TZ strings.
A file name component must not exceed 14 characters or start with <code>&#39;-&#39;</code>.</p>
</blockquote>
<h2 id="monthday-syntax">Month/Day Syntax</h2>
<p>ISO-8601 and RFC 3339 specify syntax appropriate for <code>Temporal.PlainDate</code>, <code>Temporal.PlainTime</code>, <code>Temporal.PlainDateTime</code>, and <code>Temporal.PlainYearMonth</code>, but not <code>Temporal.PlainMonthDay</code> except in the special case of a duration.
Therefore, <code>Temporal</code> defines the following convention for month/day strings:</p>
<pre><code>07-04</code></pre><p>The above string would signify July 4 in the ISO calendar.</p>
<p>RFC 3339 includes <code>--07-04</code> for a date without year component.
In the current spec, we accept this but don&#39;t emit it.</p>
<h2 id="calendar-systems">Calendar Systems</h2>
<p>In order to achieve round-trip persistence for <code>Temporal</code> objects using non-ISO calendar systems, it&#39;s needed to add a calendar system identifier to the string syntax.</p>
<p>The authors of this proposal are unaware of existing precedent for expressing a calendar system in an ISO 8601 and/or RFC 3339 string.
Therefore, we are proposing the following extension:
<em>Calendar-specific dates are expressed as their equivalent date in the ISO calendar system, with a suffix signifying the calendar system into which the ISO date should be converted when read by a computer.</em></p>
<p>For example, when parsed, the following string would represent the date <strong>28 Iyar 5780</strong> in the Hebrew calendar:</p>
<pre><code>2020-05-22[u-ca-hebrew]</code></pre><p>The syntax of the calendar suffix is currently being proposed for standardization with the CalConnect and IETF Calsify standards bodies.</p>
<p>The calendar identifiers <a href="http://unicode.org/reports/tr35/#UnicodeCalendarIdentifier">are defined by CLDR</a> as <a href="http://unicode.org/reports/tr35/#unicode_locale_extensions">a sequence of 3-8 character BCP47 subtags</a>.
The list of calendar identifiers currently supported by CLDR is:</p>
<ul>
<li><code>buddhist</code></li>
<li><code>chinese</code></li>
<li><code>coptic</code></li>
<li><code>dangi</code></li>
<li><code>ethioaa</code></li>
<li><code>ethiopic</code></li>
<li><code>gregory</code></li>
<li><code>hebrew</code></li>
<li><code>indian</code></li>
<li><code>islamic</code></li>
<li><code>islamic-umalqura</code></li>
<li><code>islamic-tbla</code></li>
<li><code>islamic-civil</code></li>
<li><code>islamic-rgsa</code></li>
<li><code>iso8601</code></li>
<li><code>japanese</code></li>
<li><code>persian</code></li>
<li><code>roc</code></li>
<li><code>islamicc</code> (deprecated in favor of <code>islamic-civil</code>)</li>
</ul>
<p>Example of a maximal length string containing both an IANA time zone name and a calendar system:</p>
<pre><code>2020-05-22T07:19:35.356-04:00[America/Indiana/Indianapolis][u-ca-islamic-umalqura]</code></pre><h3 id="calendar-dependent-yearmonth-and-monthday"><a class="heading-link" href="#calendar-dependent-yearmonth-and-monthday"></a>Calendar-dependent YearMonth and MonthDay</h3><p>Based on the data model discussion in <a href="https://github.com/tc39/proposal-temporal/issues/391">#391</a>, <code>Temporal.YearMonth</code> and <code>Temporal.MonthDay</code> use the <code>Temporal.PlainDate</code> data model when in a non-ISO calendar system.
For example, a <code>Temporal</code> object using the Hebrew calendar might store &quot;Iyar 5780&quot; in a <code>Temporal.YearMonth</code> using <code>2020-04-25</code> which is the first day of that month in the ISO calendar.</p>
<p>When expressed as an ISO string, we would say:</p>
<pre><code>2020-04-25{hebrew}</code></pre><p>Because it is ambiguous whether that string represents a <code>Temporal.PlainDate</code>, <code>Temporal.YearMonth</code>, or <code>Temporal.MonthDay</code>, the appropriate <code>Temporal</code> constructor must be chosen in order to get the expected data type back out.</p>
<h2 id="string-persistence-overview">String Persistence Overview</h2>
<p>All <code>Temporal</code> types have a string representation for persistence and interoperability.
Most of these types only require existing standards, with a few exceptions noted above.
The correspondence between types and strings is shown below.</p>
<img src="persistence-model.svg">
    <footer>
      <p>
        This page includes a script which loads an implementation of Temporal in your browser.
        You can open a console in your browser's developer tools and try it out directly!
      </p>
      <p>View this or help contribute on <a href="https://github.com/tc39/proposal-temporal">GitHub</a>.</p>
    </footer>
  </body>
</html>
