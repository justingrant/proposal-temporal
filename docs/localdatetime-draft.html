<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Temporal documentation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/light.min.css">
    <script type="application/javascript" src="./playground.js"></script>
    <link rel="stylesheet" type="text/css" href="./prism.css">
    <script>
      Temporal = { ...temporal.Temporal };
      Object.assign(Intl, temporal.Intl);

      // Customize output of Temporal objects for Chrome DevTools
      if (!window.devtoolsFormatters)
        window.devtoolsFormatters = [];
      window.devtoolsFormatters.push({
        header(x) {
          for (const type of [
            Temporal.Instant,
            Temporal.Calendar,
            Temporal.Date,
            Temporal.DateTime,
            Temporal.Duration,
            Temporal.MonthDay,
            Temporal.Time,
            Temporal.TimeZone,
            Temporal.YearMonth
          ]) {
            if (x instanceof type) return ['span', {}, `${x[Symbol.toStringTag]} <${x}>`];
          }
          return null;
        },
        hasBody(x) {
          return x instanceof Temporal.Duration;
        },
        body(x) {
          const out = ['ol', { style: 'list-style-type: none;' }];
          for (const prop of [
            'years',
            'months',
            'weeks',
            'days',
            'hours',
            'minutes',
            'seconds',
            'milliseconds',
            'microseconds',
            'nanoseconds'
          ]) {
            if (x[prop] !== 0) out.push([
              'li',
              {},
              ['span', { style: 'color: purple;' }, prop],
              `: `,
              ['span', { style: 'color: blue;' }, x[prop]]
            ]);
          }
          return out;
        }
      });
    </script>
    <style>
      /* https://github.com/kognise/water.css/blob/master/src/variables-light.css */
      :root {
        --background: #efefef;
        --text-muted: #999999;
        --text-bright: #000000;
        --text-width: 900px;
        --variable: #39a33c;
      }
      body {
        font-size: 18px;
        max-width: var(--text-width);
        padding-top: 40px;  /* extra padding for banner */
        line-height: 1.5;
      }
      pre { border-left: 4px solid var(--variable); }
      code {
        padding: 1px 5px 2px 5px;
        line-height: 1.1;
        display: inline-block;
      }
      pre code { line-height: 1.4; }
      pre code[class*="language-"] { font-size: 0.85em; }
      pre[class*="language-"] { padding: 0.5em; }
      h1 { margin-top: 13px; }
      h2 { border-bottom: 2px solid var(--text-muted); margin-top: 2em; }
      h3 {
        border-bottom: 1px solid var(--text-muted);
        color: var(--text-muted);
        font-weight: normal;
      }
      h3 em { font-weight: bold; }
      h3 strong { color: var(--text-bright); }
      :not(h2) + h3 { margin-top: 2em; }
      footer {
        border-top: 1px solid var(--background);
        color: var(--text-muted);
        font-size: 0.8em;
        margin-top: 2em;
        padding-top: 10px;
      }
      .heading-link {
        left: calc((100vw - var(--text-width)) / 2 - 1.5em);
        opacity: 0;
        position: absolute;
        transition: opacity 150ms;
      }
      .heading-link:hover { text-decoration: none; }
      .heading-link::before { content: 'Â¶'; }
      h3:hover .heading-link { opacity: 1; }
      .banner {
        /* Gradient from https://joshnh.com/weblog/how-to-make-an-alert-bar/ */
        background-color: #fce94f;
        background-image: linear-gradient(135deg,
                                          transparent,
                                          transparent 25%,
                                          rgba(0, 0, 0, .05) 25%,
                                          rgba(0, 0, 0, .05) 50%,
                                          transparent 50%,
                                          transparent 75%,
                                          rgba(0, 0, 0, .05) 75%,
                                          rgba(0, 0, 0, .05));
        background-size: 20px 20px;
        box-shadow: 0 5px 0 rgba(0, 0, 0, .1);
        left: 0;
        padding: 0.4em 0;
        position: absolute;
        text-align: center;
        top: 0;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="banner">
      This proposal is <strong><a href="https://blogs.igalia.com/compilers/2020/06/23/dates-and-times-in-javascript/">experimental.</a></strong>
      The API will change based on feedback that we get.
      <strong>Do</strong> <a href="https://forms.gle/iL9iZg7Y9LvH41Nv8">give feedback</a> and open <a href="https://github.com/tc39/proposal-temporal/issues">issues</a>; <strong>don't</strong> use it in production!
    </div>
<h1 id="zoned-datetime-type">Zoned Date/Time Type</h1>
<p><strong>Name:</strong> It&#39;s currently being referred to as <code>Temporal.LocalDateTime</code>, but we already know this is not a good name for reasons discussed years ago.
This name is not intended to stick.</p>
<p><strong>What it is:</strong> The LocalDateTime type is intended to refer to an event, that happened (or will happen) in a particular place.</p>
<p><strong>Motivation:</strong></p>
<ul>
<li>&quot;Event that happened in a particular place&quot; is a very common use case, perhaps the most common.
So we want a type that does the right thing for that use case.</li>
<li>Both Absolute and DateTime have cases where they do the right thing for this use case, and cases where they do the wrong thing.
(ex.: &quot;Move a meeting three days later&quot; is correct with DateTime and wrong with Absolute; &quot;Postpone a reminder by one hour&quot; is correct with Absolute and wrong with DateTime.)</li>
<li>The cases where Absolute and DateTime do the wrong thing will only produce the wrong result when used across a DST transition, so in many places the bugs will only pop up twice per year, if at all.</li>
<li>When writing the cookbook, to deal with this use case, we found that it was actually necessary a lot of the time to pass around a record consisting of <code>{ instant, timeZone }</code>.
If that is so common, then we may as well have a type for it.</li>
<li>Even worse, there is a temptation to pass around a serialized string instead of such a record, which is wrong because the time zone offset may have changed when you read in the string again with <code>Temporal.Instant.from()</code>.</li>
</ul>
<p><strong>API</strong>: The API looks something like this:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Temporal</span><span class="token punctuation">.</span>LocalDateTime <span class="token punctuation">{</span>
  <span class="token comment">// creation</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>instant<span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Instant<span class="token punctuation">,</span> timeZone<span class="token operator">:</span> Temporal<span class="token punctuation">.</span>TimeZone<span class="token punctuation">,</span> calendar<span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Calendar<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">from</span><span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> object<span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> object<span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>LocalDateTime<span class="token punctuation">;</span>

  <span class="token comment">// immutable 'mutation'</span>
  <span class="token keyword">with</span><span class="token punctuation">(</span>localDateTimeLike<span class="token operator">:</span> object<span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> object<span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>LocalDateTime<span class="token punctuation">;</span>
  <span class="token function">withCalendar</span><span class="token punctuation">(</span>calendar<span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Calendar<span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>LocalDateTime<span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">startOfDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>LocalDateTime<span class="token punctuation">;</span>

  <span class="token comment">// getters / field access</span>
  <span class="token keyword">get</span> <span class="token function">era</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">year</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">month</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">day</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">hour</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">minute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">second</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">millisecond</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">microsecond</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">nanosecond</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">timeZone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>TimeZone<span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">timeZoneOffsetNanoseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">timeZoneOffsetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">calendar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Calendar<span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">dayOfWeek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">dayOfYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">weekOfYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">hoursInDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">daysInMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">daysInYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">inLeapYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">isTimeZoneOffsetTransition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token function">getFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> object<span class="token punctuation">;</span>
  <span class="token function">getISOFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> object<span class="token punctuation">;</span>

  <span class="token comment">// type conversion</span>
  <span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Instant<span class="token punctuation">;</span>
  <span class="token function">toDateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>DateTime<span class="token punctuation">;</span>
  <span class="token function">toDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Date<span class="token punctuation">;</span>
  <span class="token function">toYearMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>YearMonth<span class="token punctuation">;</span>
  <span class="token function">toMonthDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>MonthDay<span class="token punctuation">;</span>
  <span class="token function">toTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Time<span class="token punctuation">;</span>

  <span class="token comment">// comparison</span>
  <span class="token keyword">static</span> <span class="token function">compare</span><span class="token punctuation">(</span>one<span class="token operator">:</span> Temporal<span class="token punctuation">.</span>LocalDateTime<span class="token punctuation">,</span> two<span class="token operator">:</span> Temporal<span class="token punctuation">.</span>LocalDateTime<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token function">equals</span><span class="token punctuation">(</span>other<span class="token operator">:</span> Temporal<span class="token punctuation">.</span>LocalDateTime<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>

  <span class="token comment">// arithmetic</span>
  <span class="token function">add</span><span class="token punctuation">(</span>duration<span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Duration <span class="token operator">|</span> object<span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> object<span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>LocalDateTime<span class="token punctuation">;</span>
  <span class="token function">subtract</span><span class="token punctuation">(</span>duration<span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Duration <span class="token operator">|</span> object<span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> object<span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>LocalDateTime<span class="token punctuation">;</span>
  <span class="token function">since</span><span class="token punctuation">(</span>other<span class="token operator">:</span> Temporal<span class="token punctuation">.</span>LocalDateTime<span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> object<span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Duration<span class="token punctuation">;</span>

  <span class="token comment">// serialization / presentation</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">toLocaleString</span><span class="token punctuation">(</span>locales<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>(This is not a fully functional description, it&#39;s made concise for readability.
For example, the details of the options bags are omitted.)</p>
<p>It basically has all the API of DateTime, but with a time zone as well, adding the time zone offset for disambiguating near transitions, and several time-zone-related convenience properties.
But since it represents an unambiguous moment in time (like Absolute, and unlike DateTime), the internal model is more like Absolute with a time zone and calendar.</p>
<p>To create one, you use <code>Temporal.LocalDateTime.from</code>, or the <code>toLocalDateTime()</code> method of another Temporal type.</p>
<ul>
<li>From a string: <code>from(string)</code></li>
<li>From raw DateTime fields: <code>from({ year, month, day, etc., timeZone, timeZoneOffsetNanoseconds })</code></li>
<li>From an Absolute: <code>instant.toLocalDateTime(timeZone)</code></li>
<li>From a DateTime, which potentially needs disambiguation: <code>dateTime.toLocalDateTime(timeZone, { disambiguation })</code></li>
</ul>
<p>As in the other Temporal types, the constructor is more low-level and takes an Absolute, a TimeZone, and a Calendar.</p>
<p>&quot;New&quot; API that is not on DateTime:</p>
<ul>
<li><code>hoursInDay</code> - this is not possible with Absolute (no concept of days and no time zone) nor with DateTime (no time zone), but it makes sense for this type.</li>
<li><code>timeZoneOffsetNanoseconds</code> - without this, you&#39;d need to do <code>ldt.timeZone.getOffsetNanoseconds(ldt.toInstant())</code>.</li>
<li><code>timeZoneOffsetString</code> - ditto, you&#39;d need <code>ldt.timeZone.getOffsetString(ldt.toInstant())</code>.</li>
<li><code>startOfDay</code> - this is a convenient way to get the start of the day, especially if the day does not start at 00:00 due to DST.
Also not needed with Absolute (no concept of days) nor with DateTime (day always starts at 00:00), but it makes sense for this type.</li>
<li><code>isTimeZoneOffsetTransition</code> - convenience property getter.</li>
</ul>
    <footer>
      <p>
        This page includes a script which loads an implementation of Temporal in your browser.
        You can open a console in your browser's developer tools and try it out directly!
      </p>
      <p>View this or help contribute on <a href="https://github.com/tc39/proposal-temporal">GitHub</a>.</p>
    </footer>
  </body>
</html>
